<div class="min-h-screen bg-background p-6">
    <div class="bg-white rounded-xl shadow-sm p-6 space-y-6">
        <h2 class="text-xl font-bold">{{ isEditMode ? 'Editar evento' : 'Nuevo evento' }}</h2>

        <form [formGroup]="eventForm" (ngSubmit)="onSubmit()" class="space-y-4">

            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <div>
                    <label class="block text-sm font-medium text-slate-700 mb-1">Nombre Interno</label>
                    <input type="text" formControlName="nameInternal"
                        class="w-full px-3 py-2 border border-slate-300 rounded-md focus:outline-none focus:border-slate-500 focus:ring-1 focus:ring-slate-500">
                </div>
                <div>
                    <label class="block text-sm font-medium text-slate-700 mb-1">Alias P√∫blico</label>
                    <input type="text" formControlName="aliasPublic"
                        class="w-full px-3 py-2 border border-slate-300 rounded-md focus:outline-none focus:border-slate-500 focus:ring-1 focus:ring-slate-500">
                </div>
            </div>

            <div>
                <label class="block text-sm font-medium text-slate-700 mb-1">Descripci√≥n Corta</label>
                <textarea formControlName="descriptionShort" rows="2"
                    class="w-full px-3 py-2 border border-slate-300 rounded-md focus:outline-none focus:border-slate-500 focus:ring-1 focus:ring-slate-500"></textarea>
            </div>

            <div>
                <label class="block text-sm font-medium text-slate-700 mb-1">Descripci√≥n Larga</label>
                <textarea formControlName="descriptionLong" rows="4"
                    class="w-full px-3 py-2 border border-slate-300 rounded-md focus:outline-none focus:border-slate-500 focus:ring-1 focus:ring-slate-500"></textarea>
            </div>

            <div>
                <label class="block text-sm font-medium text-slate-700 mb-1">Ubicaci√≥n</label>
                <input type="text" formControlName="locationAddress" placeholder="Direcci√≥n del evento"
                    class="w-full px-3 py-2 border border-slate-300 rounded-md focus:outline-none focus:border-slate-500 focus:ring-1 focus:ring-slate-500">
            </div>

            <div>
                <label class="block text-sm font-medium text-slate-700 mb-1">URL Imagen de Portada</label>
                <input type="text" formControlName="coverImageUrl"
                    class="w-full px-3 py-2 border border-slate-300 rounded-md focus:outline-none focus:border-slate-500 focus:ring-1 focus:ring-slate-500">
            </div>

            <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                <div>
                    <label class="block text-sm font-medium text-slate-700 mb-1">Tipo de Evento</label>
                    <select formControlName="eventType"
                        class="w-full px-3 py-2 border border-slate-300 rounded-md focus:outline-none focus:border-slate-500 focus:ring-1 focus:ring-slate-500">
                        <option value="teatro">Teatro</option>
                        <option value="standup">Stand-up</option>
                        <option value="musica">M√∫sica</option>
                        <option value="taller">Taller</option>
                        <option value="otro">Otro</option>
                    </select>
                </div>

                <div>
                    <label class="block text-sm font-medium text-slate-700 mb-1">Capacidad sugerida para
                        funciones</label>
                    <input type="number" formControlName="defaultCapacity"
                        class="w-full px-3 py-2 border border-slate-300 rounded-md focus:outline-none focus:border-slate-500 focus:ring-1 focus:ring-slate-500">
                    <p class="text-xs text-slate-500 mt-1">Este valor se usar√° como sugerencia al crear funciones</p>
                </div>

                <div>
                    <label class="block text-sm font-medium text-slate-700 mb-1">Estado</label>
                    <select formControlName="status"
                        class="w-full px-3 py-2 border border-slate-300 rounded-md focus:outline-none focus:border-slate-500 focus:ring-1 focus:ring-slate-500">
                        <option value="active">Activo</option>
                        <option value="inactive">Inactivo</option>
                    </select>
                </div>
            </div>

            <div class="flex items-center gap-2">
                <input type="checkbox" formControlName="isSponsored" id="sponsored"
                    class="h-4 w-4 text-slate-900 border-slate-300 rounded">
                <label for="sponsored" class="text-sm text-slate-700">
                    <span class="text-amber-500">‚òÖ</span> Evento Destacado
                </label>
            </div>

            <!-- Function Type Selection -->
            <div class="space-y-4">
                <h3 class="text-base font-semibold text-slate-900 border-b pb-2">Tipo de Funciones</h3>
                <p class="text-sm text-slate-600">¬øEste evento tiene una o varias funciones?</p>

                <div class="grid grid-cols-2 gap-4">
                    <!-- Single Function Card -->
                    <div (click)="eventForm.patchValue({functionType: 'single'})"
                        [class.border-primary]="eventForm.get('functionType')?.value === 'single'"
                        [class.bg-primary]="eventForm.get('functionType')?.value === 'single'"
                        [class.bg-opacity-5]="eventForm.get('functionType')?.value === 'single'"
                        class="cursor-pointer border-2 border-slate-200 rounded-lg p-4 hover:border-primary transition-colors">
                        <div class="text-3xl mb-2">üé≠</div>
                        <h4 class="font-semibold text-slate-900 mb-1">Funci√≥n √∫nica</h4>
                        <p class="text-sm text-slate-600">Una sola fecha y horario</p>
                    </div>

                    <!-- Multiple Functions Card -->
                    <div (click)="eventForm.patchValue({functionType: 'multiple'})"
                        [class.border-primary]="eventForm.get('functionType')?.value === 'multiple'"
                        [class.bg-primary]="eventForm.get('functionType')?.value === 'multiple'"
                        [class.bg-opacity-5]="eventForm.get('functionType')?.value === 'multiple'"
                        class="cursor-pointer border-2 border-slate-200 rounded-lg p-4 hover:border-primary transition-colors">
                        <div class="text-3xl mb-2">üìÖ</div>
                        <h4 class="font-semibold text-slate-900 mb-1">M√∫ltiples funciones</h4>
                        <p class="text-sm text-slate-600">Varias fechas u horarios</p>
                    </div>
                </div>

                <!-- Single Function Fields (conditional) -->
                <div *ngIf="eventForm.get('functionType')?.value === 'single'"
                    class="space-y-4 bg-slate-50 p-4 rounded-lg border border-slate-200">
                    <p class="text-sm text-slate-600 flex items-center gap-2">
                        <span class="text-lg">‚ÑπÔ∏è</span>
                        Se crear√° autom√°ticamente una funci√≥n con estos datos
                    </p>

                    <div class="grid grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-medium text-slate-700 mb-1">Fecha</label>
                            <input type="date" formControlName="functionDate"
                                class="w-full px-3 py-2 border border-slate-300 rounded-md focus:outline-none focus:border-primary focus:ring-1 focus:ring-primary">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-slate-700 mb-1">Hora</label>
                            <input type="time" formControlName="functionTime"
                                class="w-full px-3 py-2 border border-slate-300 rounded-md focus:outline-none focus:border-primary focus:ring-1 focus:ring-primary">
                        </div>
                    </div>

                    <div>
                        <label class="block text-sm font-medium text-slate-700 mb-1">Cerrar reservas (minutos
                            antes)</label>
                        <input type="number" formControlName="functionAutoClose"
                            class="w-full px-3 py-2 border border-slate-300 rounded-md focus:outline-none focus:border-primary focus:ring-1 focus:ring-primary">
                    </div>
                </div>

                <!-- Multiple Functions Message (conditional) -->
                <div *ngIf="eventForm.get('functionType')?.value === 'multiple'"
                    class="bg-blue-50 border border-blue-200 rounded-lg p-4">
                    <p class="text-sm text-blue-800 flex items-center gap-2">
                        <span class="text-lg">üìÖ</span>
                        Podr√°s agregar las funciones despu√©s de crear el evento
                    </p>
                </div>
            </div>

            <!-- Pricing Configuration -->
            <div class="space-y-4">
                <h3 class="text-base font-semibold text-slate-900 border-b pb-2">Configuraci√≥n de Precios</h3>
                <p class="text-sm text-slate-600">¬øC√≥mo se vender√°n las entradas?</p>

                <div class="space-y-3">
                    <!-- Fixed Price Option -->
                    <div class="border rounded-lg transition-all"
                        [class.border-slate-900]="eventForm.get('pricingType')?.value === 'fixed'"
                        [class.border-slate-300]="eventForm.get('pricingType')?.value !== 'fixed'">

                        <label
                            class="flex items-start gap-3 p-3 cursor-pointer hover:bg-slate-50 transition-colors rounded-t-lg">
                            <input type="radio" formControlName="pricingType" value="fixed"
                                class="mt-1 h-4 w-4 text-slate-900 border-slate-300">
                            <div class="flex-1">
                                <div class="font-medium text-slate-900">Precio fijo</div>
                                <div class="text-sm text-slate-600">Las entradas tienen un precio establecido</div>
                            </div>
                        </label>

                        <!-- Price Field (inside card) -->
                        <div *ngIf="eventForm.get('pricingType')?.value === 'fixed'"
                            class="px-3 pb-3 pt-2 border-t border-slate-200 bg-slate-50/50">
                            <div>
                                <label class="block text-xs font-medium text-slate-700 mb-1">Precio por entrada</label>
                                <div class="relative">
                                    <span class="absolute left-3 top-2 text-sm text-slate-500">$</span>
                                    <input type="number" formControlName="defaultPrice" placeholder="0"
                                        class="w-full pl-7 pr-3 py-2 text-sm border border-slate-300 rounded-md focus:outline-none focus:border-slate-500 focus:ring-1 focus:ring-slate-500">
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Pay What You Want Option -->
                    <div class="border rounded-lg transition-all"
                        [class.border-slate-900]="eventForm.get('pricingType')?.value === 'pay-what-you-want'"
                        [class.border-slate-300]="eventForm.get('pricingType')?.value !== 'pay-what-you-want'">

                        <label
                            class="flex items-start gap-3 p-3 cursor-pointer hover:bg-slate-50 transition-colors rounded-t-lg">
                            <input type="radio" formControlName="pricingType" value="pay-what-you-want"
                                class="mt-1 h-4 w-4 text-slate-900 border-slate-300">
                            <div class="flex-1">
                                <div class="font-medium text-slate-900">A la gorra</div>
                                <div class="text-sm text-slate-600">El cliente decide cu√°nto pagar</div>
                            </div>
                        </label>

                        <!-- Suggested Price Field (inside card) -->
                        <div *ngIf="eventForm.get('pricingType')?.value === 'pay-what-you-want'"
                            class="px-3 pb-3 pt-2 border-t border-slate-200 bg-slate-50/50">
                            <div>
                                <label class="block text-xs font-medium text-slate-700 mb-1">Precio sugerido
                                    (opcional)</label>
                                <div class="relative">
                                    <span class="absolute left-3 top-2 text-sm text-slate-500">$</span>
                                    <input type="number" formControlName="suggestedPrice" placeholder="0"
                                        class="w-full pl-7 pr-3 py-2 text-sm border border-slate-300 rounded-md focus:outline-none focus:border-slate-500 focus:ring-1 focus:ring-slate-500">
                                </div>
                                <p class="mt-1 text-xs text-slate-500">Este monto se mostrar√° como referencia</p>
                            </div>
                        </div>
                    </div>

                    <!-- Free Entry Option -->
                    <div class="border rounded-lg transition-all"
                        [class.border-slate-900]="eventForm.get('pricingType')?.value === 'free'"
                        [class.border-slate-300]="eventForm.get('pricingType')?.value !== 'free'">

                        <label class="flex items-start gap-3 p-3 cursor-pointer hover:bg-slate-50 transition-colors">
                            <input type="radio" formControlName="pricingType" value="free"
                                class="mt-1 h-4 w-4 text-slate-900 border-slate-300">
                            <div class="flex-1">
                                <div class="font-medium text-slate-900">Entrada gratuita</div>
                                <div class="text-sm text-slate-600">Sin costo para los asistentes</div>
                            </div>
                        </label>
                    </div>
                </div>
            </div>

            <div class="space-y-4">
                <h3 class="text-base font-semibold text-slate-900 border-b pb-2">Gesti√≥n de Pagos</h3>
                <p class="text-sm text-slate-600">¬øC√≥mo quer√©s gestionar los pagos de este evento?</p>

                <div class="space-y-3">
                    <!-- Platform Payment Option -->
                    <div class="border rounded-lg transition-all"
                        [class.border-slate-900]="eventForm.get('paymentMethod')?.value === 'platform'"
                        [class.border-slate-300]="eventForm.get('paymentMethod')?.value !== 'platform'">

                        <label
                            class="flex items-start gap-3 p-3 cursor-pointer hover:bg-slate-50 transition-colors rounded-t-lg">
                            <input type="radio" formControlName="paymentMethod" value="platform"
                                class="mt-1 h-4 w-4 text-slate-900 border-slate-300">
                            <div class="flex-1">
                                <div class="font-medium text-slate-900">Cobro por la plataforma</div>
                                <div class="text-sm text-slate-600">Los clientes pagan y vos recib√≠s el dinero en tu
                                    cuenta
                                    bancaria</div>
                            </div>
                        </label>

                        <!-- Bank Info Fields (inside card) -->
                        <div *ngIf="eventForm.get('paymentMethod')?.value === 'platform'"
                            class="px-3 pb-3 pt-2 border-t border-slate-200 bg-slate-50/50" formGroupName="bankInfo">
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-3">
                                <div>
                                    <label class="block text-xs font-medium text-slate-700 mb-1">Alias</label>
                                    <input type="text" formControlName="alias" placeholder="enpuerta.mp"
                                        class="w-full px-3 py-2 text-sm border border-slate-300 rounded-md focus:outline-none focus:border-slate-500 focus:ring-1 focus:ring-slate-500">
                                </div>

                                <div>
                                    <label class="block text-xs font-medium text-slate-700 mb-1">CBU</label>
                                    <input type="text" formControlName="cbu" placeholder="0000003100010000000001"
                                        pattern="[0-9]*" inputmode="numeric"
                                        class="w-full px-3 py-2 text-sm border border-slate-300 rounded-md focus:outline-none focus:border-slate-500 focus:ring-1 focus:ring-slate-500">
                                </div>

                                <div>
                                    <label class="block text-xs font-medium text-slate-700 mb-1">Titular</label>
                                    <input type="text" formControlName="titular" placeholder="Nombre del titular"
                                        class="w-full px-3 py-2 text-sm border border-slate-300 rounded-md focus:outline-none focus:border-slate-500 focus:ring-1 focus:ring-slate-500">
                                </div>

                                <div>
                                    <label class="block text-xs font-medium text-slate-700 mb-1">Tel√©fono para
                                        comprobantes</label>
                                    <input type="tel" formControlName="telefonoComprobantes"
                                        placeholder="+5493511234567"
                                        class="w-full px-3 py-2 text-sm border border-slate-300 rounded-md focus:outline-none focus:border-slate-500 focus:ring-1 focus:ring-slate-500">
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Contact Only Option -->
                    <div class="border rounded-lg transition-all"
                        [class.border-slate-900]="eventForm.get('paymentMethod')?.value === 'contact'"
                        [class.border-slate-300]="eventForm.get('paymentMethod')?.value !== 'contact'">

                        <label
                            class="flex items-start gap-3 p-3 cursor-pointer hover:bg-slate-50 transition-colors rounded-t-lg">
                            <input type="radio" formControlName="paymentMethod" value="contact"
                                class="mt-1 h-4 w-4 text-slate-900 border-slate-300">
                            <div class="flex-1">
                                <div class="font-medium text-slate-900">Solo contacto directo</div>
                                <div class="text-sm text-slate-600">Los clientes te contactan directamente para
                                    coordinar el
                                    pago</div>
                            </div>
                        </label>

                        <!-- Contact Info Fields (inside card) -->
                        <div *ngIf="eventForm.get('paymentMethod')?.value === 'contact'"
                            class="px-3 pb-3 pt-2 border-t border-slate-200 bg-slate-50/50" formGroupName="contactInfo">
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-3">
                                <div>
                                    <label class="block text-xs font-medium text-slate-700 mb-1">Nombre de
                                        contacto</label>
                                    <input type="text" formControlName="contactName" placeholder="Tu nombre"
                                        class="w-full px-3 py-2 text-sm border border-slate-300 rounded-md focus:outline-none focus:border-slate-500 focus:ring-1 focus:ring-slate-500">
                                </div>

                                <div>
                                    <label class="block text-xs font-medium text-slate-700 mb-1">Tel√©fono de
                                        contacto</label>
                                    <input type="tel" formControlName="contactPhone" placeholder="+5493511234567"
                                        class="w-full px-3 py-2 text-sm border border-slate-300 rounded-md focus:outline-none focus:border-slate-500 focus:ring-1 focus:ring-slate-500">
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Info Message -->
            <div class="mt-6 p-3 bg-blue-50 border border-blue-200 rounded-lg">
                <p class="text-sm text-blue-800">
                    <strong>üí° Nota:</strong> Podr√°s cargar las funciones una vez que hayas creado el evento.
                </p>
            </div>

            <!-- Buttons -->
            <div class="flex justify-end gap-3 pt-4">
                <a routerLink="/events"
                    class="px-4 py-2 border border-slate-300 text-slate-700 rounded-full hover:bg-slate-50">
                    Cancelar
                </a>
                <button type="submit" [disabled]="eventForm.invalid || loading"
                    class="bg-primary hover:bg-primary-hover text-white px-4 py-2 rounded-full disabled:opacity-50">
                    {{ loading ? 'Guardando...' : 'Guardar' }}
                </button>
            </div>
        </form>
    </div>
</div>