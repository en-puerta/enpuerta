<div>
    <div class="bg-white rounded-xl shadow-sm p-8 space-y-6 max-w-4xl mx-auto">
        <!-- Header -->
        <div class="border-b border-slate-200 pb-6">
            <h2 class="text-2xl font-bold text-slate-900">{{ isEditMode ? 'Editar evento' : 'Nuevo evento' }}</h2>
            <p class="text-sm text-slate-600 mt-1">Complet√° la informaci√≥n en 3 simples pasos</p>
        </div>

        <!-- Progress Indicator -->
        <div class="mb-8">
            <!-- Circles and Lines -->
            <div class="flex items-center justify-center mb-4">
                <div class="flex items-center max-w-md w-full">
                    <div *ngFor="let step of [1, 2, 3]; let i = index" class="flex items-center" [class.flex-1]="i < 2">
                        <!-- Step Circle -->
                        <button type="button" (click)="goToStep(step)" [class.bg-primary]="currentStep >= step"
                            [class.text-white]="currentStep >= step" [class.bg-slate-200]="currentStep < step"
                            [class.text-slate-500]="currentStep < step" [class.cursor-pointer]="step < currentStep"
                            [class.cursor-not-allowed]="step > currentStep"
                            class="w-10 h-10 rounded-full flex items-center justify-center font-semibold text-sm transition-all z-10 relative shrink-0">
                            <span *ngIf="isStepComplete(step) && step < currentStep">‚úì</span>
                            <span *ngIf="!isStepComplete(step) || step >= currentStep">{{ step }}</span>
                        </button>

                        <!-- Connector Line -->
                        <div *ngIf="i < 2" class="flex-1 h-1 mx-3" [class.bg-primary]="currentStep > step"
                            [class.bg-slate-200]="currentStep <= step"></div>
                    </div>
                </div>
            </div>

            <!-- Step Labels -->
            <div class="grid grid-cols-3 gap-2 max-w-md mx-auto">
                <div class="text-center">
                    <p class="text-xs font-medium" [class.text-primary]="currentStep === 1"
                        [class.text-slate-600]="currentStep !== 1">
                        Informaci√≥n B√°sica
                    </p>
                </div>
                <div class="text-center">
                    <p class="text-xs font-medium" [class.text-primary]="currentStep === 2"
                        [class.text-slate-600]="currentStep !== 2">
                        Funciones y Precios
                    </p>
                </div>
                <div class="text-center">
                    <p class="text-xs font-medium" [class.text-primary]="currentStep === 3"
                        [class.text-slate-600]="currentStep !== 3">
                        Gesti√≥n de Pagos
                    </p>
                </div>
            </div>
        </div>

        <form [formGroup]="eventForm" (ngSubmit)="onSubmit()" class="space-y-6">

            <!-- STEP 1: Basic Information -->
            <div *ngIf="currentStep === 1" class="space-y-6 animate-fadeIn">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-slate-700 mb-2">Nombre Interno *</label>
                        <input type="text" formControlName="nameInternal" placeholder="Ej: Hamlet 2025"
                            class="w-full px-4 py-2.5 border border-slate-300 rounded-lg focus:outline-none focus:border-primary focus:ring-2 focus:ring-primary/20 transition-colors">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-slate-700 mb-2">Alias P√∫blico *</label>
                        <input type="text" formControlName="aliasPublic" placeholder="Ej: hamlet-2025"
                            class="w-full px-4 py-2.5 border border-slate-300 rounded-lg focus:outline-none focus:border-primary focus:ring-2 focus:ring-primary/20 transition-colors">
                    </div>
                </div>

                <div>
                    <label class="block text-sm font-medium text-slate-700 mb-2">Descripci√≥n Corta</label>
                    <textarea formControlName="descriptionShort" rows="2" placeholder="Breve descripci√≥n del evento"
                        class="w-full px-4 py-2.5 border border-slate-300 rounded-lg focus:outline-none focus:border-primary focus:ring-2 focus:ring-primary/20 transition-colors resize-none"></textarea>
                </div>

                <div>
                    <label class="block text-sm font-medium text-slate-700 mb-2">Descripci√≥n Larga</label>
                    <textarea formControlName="descriptionLong" rows="4" placeholder="Descripci√≥n detallada del evento"
                        class="w-full px-4 py-2.5 border border-slate-300 rounded-lg focus:outline-none focus:border-primary focus:ring-2 focus:ring-primary/20 transition-colors resize-none"></textarea>
                </div>

                <div>
                    <label class="block text-sm font-medium text-slate-700 mb-2">Ubicaci√≥n</label>
                    <input type="text" formControlName="locationAddress" placeholder="Direcci√≥n del evento"
                        class="w-full px-4 py-2.5 border border-slate-300 rounded-lg focus:outline-none focus:border-primary focus:ring-2 focus:ring-primary/20 transition-colors">
                </div>

                <div>
                    <label class="block text-sm font-medium text-slate-700 mb-2">URL Imagen de Portada</label>
                    <input type="text" formControlName="coverImageUrl" placeholder="https://..."
                        class="w-full px-4 py-2.5 border border-slate-300 rounded-lg focus:outline-none focus:border-primary focus:ring-2 focus:ring-primary/20 transition-colors">
                </div>

                <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-slate-700 mb-2">Tipo de Evento *</label>
                        <select formControlName="eventType"
                            class="w-full px-4 py-2.5 border border-slate-300 rounded-lg focus:outline-none focus:border-primary focus:ring-2 focus:ring-primary/20 transition-colors bg-white">
                            <option value="teatro">Teatro</option>
                            <option value="standup">Stand-up</option>
                            <option value="musica">M√∫sica</option>
                            <option value="taller">Taller</option>
                            <option value="otro">Otro</option>
                        </select>
                    </div>

                    <div>
                        <label class="block text-sm font-medium text-slate-700 mb-2">Capacidad sugerida *</label>
                        <input type="number" formControlName="defaultCapacity"
                            class="w-full px-4 py-2.5 border border-slate-300 rounded-lg focus:outline-none focus:border-primary focus:ring-2 focus:ring-primary/20 transition-colors">
                        <p class="text-xs text-slate-500 mt-1">Valor por defecto para funciones</p>
                    </div>

                    <div>
                        <label class="block text-sm font-medium text-slate-700 mb-2">Estado *</label>
                        <select formControlName="status"
                            class="w-full px-4 py-2.5 border border-slate-300 rounded-lg focus:outline-none focus:border-primary focus:ring-2 focus:ring-primary/20 transition-colors bg-white">
                            <option value="active">Activo</option>
                            <option value="inactive">Inactivo</option>
                        </select>
                    </div>
                </div>

                <div class="flex items-start gap-3 p-4 bg-amber-50 border border-amber-200 rounded-lg">
                    <input type="checkbox" formControlName="isSponsored" id="sponsored"
                        class="h-5 w-5 text-primary border-slate-300 rounded focus:ring-2 focus:ring-primary/20 mt-0.5">
                    <div class="flex-1">
                        <label for="sponsored" class="text-sm font-medium text-slate-700 cursor-pointer block">
                            <span class="text-amber-500 text-lg">‚òÖ</span> Marcar como evento destacado
                        </label>
                        <p *ngIf="eventForm.get('isSponsored')?.value"
                            class="text-xs text-amber-700 mt-2 flex items-start gap-1">
                            <span class="text-sm">üí∞</span>
                            <span>Se cobrar√° un monto de <strong>$5.000</strong> por evento promocionado. Los eventos
                                destacados aparecen primero en la p√°gina principal.</span>
                        </p>
                    </div>
                </div>
            </div>

            <!-- STEP 2: Functions & Pricing -->
            <div *ngIf="currentStep === 2" class="space-y-6 animate-fadeIn">
                <!-- Function Type Selection -->
                <div class="space-y-4">
                    <h3 class="text-lg font-semibold text-slate-900">Tipo de Funciones</h3>
                    <p class="text-sm text-slate-600">¬øEste evento tiene una o varias funciones?</p>

                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div (click)="eventForm.patchValue({functionType: 'single'})"
                            [class.border-primary]="eventForm.get('functionType')?.value === 'single'"
                            [class.bg-primary/5]="eventForm.get('functionType')?.value === 'single'"
                            [class.shadow-md]="eventForm.get('functionType')?.value === 'single'"
                            class="cursor-pointer border-2 border-slate-200 rounded-xl p-6 hover:border-primary hover:shadow-sm transition-all">
                            <div class="text-4xl mb-3">üé≠</div>
                            <h4 class="font-semibold text-slate-900 mb-2">Funci√≥n √∫nica</h4>
                            <p class="text-sm text-slate-600">Una sola fecha y horario</p>
                        </div>

                        <div (click)="eventForm.patchValue({functionType: 'multiple'})"
                            [class.border-primary]="eventForm.get('functionType')?.value === 'multiple'"
                            [class.bg-primary/5]="eventForm.get('functionType')?.value === 'multiple'"
                            [class.shadow-md]="eventForm.get('functionType')?.value === 'multiple'"
                            class="cursor-pointer border-2 border-slate-200 rounded-xl p-6 hover:border-primary hover:shadow-sm transition-all">
                            <div class="text-4xl mb-3">üìÖ</div>
                            <h4 class="font-semibold text-slate-900 mb-2">M√∫ltiples funciones</h4>
                            <p class="text-sm text-slate-600">Varias fechas u horarios</p>
                        </div>
                    </div>

                    <!-- Single Function Fields -->
                    <div *ngIf="eventForm.get('functionType')?.value === 'single'"
                        class="space-y-4 bg-slate-50 p-6 rounded-xl border border-slate-200">
                        <p class="text-sm text-slate-600 flex items-center gap-2">
                            <span class="text-lg">‚ÑπÔ∏è</span>
                            Se crear√° autom√°ticamente una funci√≥n con estos datos
                        </p>

                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div>
                                <label class="block text-sm font-medium text-slate-700 mb-2">Fecha *</label>
                                <input type="date" formControlName="functionDate"
                                    class="w-full px-4 py-2.5 border border-slate-300 rounded-lg focus:outline-none focus:border-primary focus:ring-2 focus:ring-primary/20 transition-colors bg-white">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-slate-700 mb-2">Hora *</label>
                                <input type="time" formControlName="functionTime"
                                    class="w-full px-4 py-2.5 border border-slate-300 rounded-lg focus:outline-none focus:border-primary focus:ring-2 focus:ring-primary/20 transition-colors bg-white">
                            </div>
                        </div>

                        <div>
                            <label class="block text-sm font-medium text-slate-700 mb-2">Cerrar reservas (minutos
                                antes)</label>
                            <input type="number" formControlName="functionAutoClose"
                                class="w-full px-4 py-2.5 border border-slate-300 rounded-lg focus:outline-none focus:border-primary focus:ring-2 focus:ring-primary/20 transition-colors">
                        </div>
                    </div>

                    <!-- Multiple Functions Message -->
                    <div *ngIf="eventForm.get('functionType')?.value === 'multiple'"
                        class="bg-blue-50 border border-blue-200 rounded-xl p-4">
                        <p class="text-sm text-blue-800 flex items-center gap-2">
                            <span class="text-lg">üìÖ</span>
                            Podr√°s agregar las funciones despu√©s de crear el evento
                        </p>
                    </div>
                </div>

                <!-- Pricing Configuration -->
                <div class="space-y-4">
                    <h3 class="text-lg font-semibold text-slate-900">Configuraci√≥n de Precios</h3>
                    <p class="text-sm text-slate-600">¬øC√≥mo se vender√°n las entradas?</p>

                    <div class="space-y-3">
                        <!-- Fixed Price -->
                        <div class="border-2 rounded-xl transition-all"
                            [class.border-primary]="eventForm.get('pricingType')?.value === 'fixed'"
                            [class.shadow-md]="eventForm.get('pricingType')?.value === 'fixed'"
                            [class.border-slate-200]="eventForm.get('pricingType')?.value !== 'fixed'">
                            <label
                                class="flex items-start gap-3 p-4 cursor-pointer hover:bg-slate-50 transition-colors rounded-t-xl">
                                <input type="radio" formControlName="pricingType" value="fixed"
                                    class="mt-1 h-5 w-5 text-primary border-slate-300 focus:ring-2 focus:ring-primary/20">
                                <div class="flex-1">
                                    <div class="font-semibold text-slate-900">Precio fijo</div>
                                    <div class="text-sm text-slate-600">Las entradas tienen un precio establecido</div>
                                </div>
                            </label>
                            <div *ngIf="eventForm.get('pricingType')?.value === 'fixed'"
                                class="px-4 pb-4 pt-2 border-t border-slate-200 bg-slate-50/50">
                                <label class="block text-sm font-medium text-slate-700 mb-2">Precio por entrada</label>
                                <div class="relative">
                                    <span class="absolute left-4 top-3 text-slate-500 font-medium">$</span>
                                    <input type="number" formControlName="defaultPrice" placeholder="0"
                                        class="w-full pl-8 pr-4 py-2.5 border border-slate-300 rounded-lg focus:outline-none focus:border-primary focus:ring-2 focus:ring-primary/20 transition-colors">
                                </div>
                            </div>
                        </div>

                        <!-- Pay What You Want -->
                        <div class="border-2 rounded-xl transition-all"
                            [class.border-primary]="eventForm.get('pricingType')?.value === 'pay-what-you-want'"
                            [class.shadow-md]="eventForm.get('pricingType')?.value === 'pay-what-you-want'"
                            [class.border-slate-200]="eventForm.get('pricingType')?.value !== 'pay-what-you-want'">
                            <label
                                class="flex items-start gap-3 p-4 cursor-pointer hover:bg-slate-50 transition-colors rounded-t-xl">
                                <input type="radio" formControlName="pricingType" value="pay-what-you-want"
                                    class="mt-1 h-5 w-5 text-primary border-slate-300 focus:ring-2 focus:ring-primary/20">
                                <div class="flex-1">
                                    <div class="font-semibold text-slate-900">A la gorra</div>
                                    <div class="text-sm text-slate-600">El cliente decide cu√°nto pagar</div>
                                </div>
                            </label>
                            <div *ngIf="eventForm.get('pricingType')?.value === 'pay-what-you-want'"
                                class="px-4 pb-4 pt-2 border-t border-slate-200 bg-slate-50/50">
                                <label class="block text-sm font-medium text-slate-700 mb-2">Precio sugerido
                                    (opcional)</label>
                                <div class="relative">
                                    <span class="absolute left-4 top-3 text-slate-500 font-medium">$</span>
                                    <input type="number" formControlName="suggestedPrice" placeholder="0"
                                        class="w-full pl-8 pr-4 py-2.5 border border-slate-300 rounded-lg focus:outline-none focus:border-primary focus:ring-2 focus:ring-primary/20 transition-colors">
                                </div>
                                <p class="mt-2 text-xs text-slate-500">Este monto se mostrar√° como referencia</p>
                            </div>
                        </div>

                        <!-- Free Entry -->
                        <div class="border-2 rounded-xl transition-all"
                            [class.border-primary]="eventForm.get('pricingType')?.value === 'free'"
                            [class.shadow-md]="eventForm.get('pricingType')?.value === 'free'"
                            [class.border-slate-200]="eventForm.get('pricingType')?.value !== 'free'">
                            <label
                                class="flex items-start gap-3 p-4 cursor-pointer hover:bg-slate-50 transition-colors rounded-xl">
                                <input type="radio" formControlName="pricingType" value="free"
                                    class="mt-1 h-5 w-5 text-primary border-slate-300 focus:ring-2 focus:ring-primary/20">
                                <div class="flex-1">
                                    <div class="font-semibold text-slate-900">Entrada gratuita</div>
                                    <div class="text-sm text-slate-600">Sin costo para los asistentes</div>
                                </div>
                            </label>
                        </div>
                    </div>
                </div>
            </div>

            <!-- STEP 3: Payment Management -->
            <div *ngIf="currentStep === 3" class="space-y-6 animate-fadeIn">
                <h3 class="text-lg font-semibold text-slate-900">Gesti√≥n de Pagos</h3>
                <p class="text-sm text-slate-600">¬øC√≥mo quer√©s gestionar los pagos de este evento?</p>

                <div class="space-y-3">
                    <!-- Platform Payment -->
                    <div class="border-2 rounded-xl transition-all"
                        [class.border-primary]="eventForm.get('paymentMethod')?.value === 'platform'"
                        [class.shadow-md]="eventForm.get('paymentMethod')?.value === 'platform'"
                        [class.border-slate-200]="eventForm.get('paymentMethod')?.value !== 'platform'">
                        <label
                            class="flex items-start gap-3 p-4 cursor-pointer hover:bg-slate-50 transition-colors rounded-t-xl">
                            <input type="radio" formControlName="paymentMethod" value="platform"
                                class="mt-1 h-5 w-5 text-primary border-slate-300 focus:ring-2 focus:ring-primary/20">
                            <div class="flex-1">
                                <div class="font-semibold text-slate-900">Cobro por la plataforma</div>
                                <div class="text-sm text-slate-600">Los clientes pagan y vos recib√≠s el dinero en tu
                                    cuenta bancaria</div>
                            </div>
                        </label>
                        <div *ngIf="eventForm.get('paymentMethod')?.value === 'platform'"
                            class="px-4 pb-4 pt-2 border-t border-slate-200 bg-slate-50/50" formGroupName="bankInfo">
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                <div>
                                    <label class="block text-sm font-medium text-slate-700 mb-2">Alias</label>
                                    <input type="text" formControlName="alias" placeholder="enpuerta.mp"
                                        class="w-full px-4 py-2.5 border border-slate-300 rounded-lg focus:outline-none focus:border-primary focus:ring-2 focus:ring-primary/20 transition-colors">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-slate-700 mb-2">CBU</label>
                                    <input type="text" formControlName="cbu" placeholder="0000003100010000000001"
                                        pattern="[0-9]*" inputmode="numeric"
                                        class="w-full px-4 py-2.5 border border-slate-300 rounded-lg focus:outline-none focus:border-primary focus:ring-2 focus:ring-primary/20 transition-colors">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-slate-700 mb-2">Titular</label>
                                    <input type="text" formControlName="titular" placeholder="Nombre del titular"
                                        class="w-full px-4 py-2.5 border border-slate-300 rounded-lg focus:outline-none focus:border-primary focus:ring-2 focus:ring-primary/20 transition-colors">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-slate-700 mb-2">Tel√©fono para
                                        comprobantes</label>
                                    <input type="tel" formControlName="telefonoComprobantes"
                                        placeholder="+5493511234567"
                                        class="w-full px-4 py-2.5 border border-slate-300 rounded-lg focus:outline-none focus:border-primary focus:ring-2 focus:ring-primary/20 transition-colors">
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Contact Only -->
                    <div class="border-2 rounded-xl transition-all"
                        [class.border-primary]="eventForm.get('paymentMethod')?.value === 'contact'"
                        [class.shadow-md]="eventForm.get('paymentMethod')?.value === 'contact'"
                        [class.border-slate-200]="eventForm.get('paymentMethod')?.value !== 'contact'">
                        <label
                            class="flex items-start gap-3 p-4 cursor-pointer hover:bg-slate-50 transition-colors rounded-t-xl">
                            <input type="radio" formControlName="paymentMethod" value="contact"
                                class="mt-1 h-5 w-5 text-primary border-slate-300 focus:ring-2 focus:ring-primary/20">
                            <div class="flex-1">
                                <div class="font-semibold text-slate-900">Solo contacto directo</div>
                                <div class="text-sm text-slate-600">Los clientes te contactan directamente para
                                    coordinar el pago</div>
                            </div>
                        </label>
                        <div *ngIf="eventForm.get('paymentMethod')?.value === 'contact'"
                            class="px-4 pb-4 pt-2 border-t border-slate-200 bg-slate-50/50" formGroupName="contactInfo">
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                <div>
                                    <label class="block text-sm font-medium text-slate-700 mb-2">Nombre de
                                        contacto</label>
                                    <input type="text" formControlName="contactName" placeholder="Tu nombre"
                                        class="w-full px-4 py-2.5 border border-slate-300 rounded-lg focus:outline-none focus:border-primary focus:ring-2 focus:ring-primary/20 transition-colors">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-slate-700 mb-2">Tel√©fono de
                                        contacto</label>
                                    <input type="tel" formControlName="contactPhone" placeholder="+5493511234567"
                                        class="w-full px-4 py-2.5 border border-slate-300 rounded-lg focus:outline-none focus:border-primary focus:ring-2 focus:ring-primary/20 transition-colors">
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Navigation Buttons -->
            <div class="flex justify-between gap-3 pt-6 border-t border-slate-200">
                <div>
                    <a *ngIf="currentStep === 1" routerLink="/events"
                        class="px-6 py-2.5 border-2 border-slate-300 text-slate-700 rounded-lg hover:bg-slate-50 font-medium transition-colors inline-block">
                        Cancelar
                    </a>
                    <button *ngIf="currentStep > 1" type="button" (click)="previousStep()"
                        class="px-6 py-2.5 border-2 border-slate-300 text-slate-700 rounded-lg hover:bg-slate-50 font-medium transition-colors">
                        ‚Üê Anterior
                    </button>
                </div>

                <div>
                    <button *ngIf="currentStep < totalSteps" type="button" (click)="nextStep()"
                        [disabled]="!canProceedToNextStep()"
                        class="px-6 py-2.5 bg-primary hover:bg-primary-hover text-white rounded-lg disabled:opacity-50 disabled:cursor-not-allowed font-semibold transition-colors shadow-sm">
                        Siguiente ‚Üí
                    </button>
                    <button *ngIf="currentStep === totalSteps" type="submit" [disabled]="eventForm.invalid || loading"
                        class="px-6 py-2.5 bg-primary hover:bg-primary-hover text-white rounded-lg disabled:opacity-50 disabled:cursor-not-allowed font-semibold transition-colors shadow-sm">
                        {{ loading ? 'Guardando...' : 'Guardar evento' }}
                    </button>
                </div>
            </div>
        </form>
    </div>
</div>