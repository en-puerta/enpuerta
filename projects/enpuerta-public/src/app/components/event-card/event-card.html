<div class="bg-white rounded-xl shadow-sm hover:shadow-lg transition-all duration-300 overflow-hidden border border-slate-200 flex flex-col h-full group"
    [ngClass]="{'opacity-75': isSoldOut}">
    <!-- Image -->
    <div
        class="relative h-32 sm:h-48 overflow-hidden bg-white flex items-center justify-center border-b border-slate-100">
        <img [src]="event.coverImageUrl || 'assets/placeholder-event.jpg'" [alt]="event.nameInternal"
            class="w-full h-full object-cover group-hover:scale-105 transition-transform duration-500"
            onerror="this.style.display='none'; this.parentElement.querySelector('.fallback-logo').style.display='flex';">
        <div class="fallback-logo hidden w-full h-full flex-col items-center justify-center gap-2 p-8"
            style="display:none;">
            <img src="assets/images/logo-icon.jpg" alt="EnPuerta" class="w-full h-full object-cover opacity-15">
        </div>

        <!-- Chip -->
        <div class="absolute top-2 left-2">
            <span
                class="bg-primary/90 backdrop-blur-sm text-white text-[10px] font-bold px-2 py-0.5 rounded-full uppercase tracking-wide shadow-sm">
                {{ event.eventType }}
            </span>
        </div>

        <!-- Sold Out Badge -->
        <div *ngIf="isSoldOut" class="absolute top-2 right-2">
            <span
                class="bg-red-600 text-white text-[10px] font-bold px-2 py-0.5 rounded-full uppercase tracking-wide shadow-lg">
                Agotado
            </span>
        </div>
    </div>

    <!-- Content -->
    <div class="p-3 sm:p-4 flex-1 flex flex-col bg-gradient-to-b from-white to-background/30">
        <h3 class="text-sm sm:text-base font-bold text-slate-900 mb-1.5 group-hover:text-primary transition-colors line-clamp-2"
            [title]="event.nameInternal">
            {{ event.nameInternal }}
        </h3>

        <p *ngIf="!hideDescription" class="text-slate-500 text-xs sm:text-sm mb-3 line-clamp-1 flex-1">
            {{ event.descriptionShort }}
        </p>

        <!-- Next Function Info (without label) -->
        <div *ngIf="nextFunction" class="mb-3 p-2 sm:p-2.5 bg-background rounded-lg border border-primary/20">
            <!-- Removed header, just show the info -->
            <div class="grid grid-cols-2 gap-2">
                <!-- Left column: Date and Price -->
                <div class="space-y-1.5">
                    <!-- Date -->
                    <div class="flex items-center gap-1.5">
                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5"
                            stroke="currentColor" class="w-3 h-3 text-slate-600">
                            <path stroke-linecap="round" stroke-linejoin="round"
                                d="M6.75 3v2.25M17.25 3v2.25M3 18.75V7.5a2.25 2.25 0 0 1 2.25-2.25h13.5A2.25 2.25 0 0 1 21 7.5v11.25m-18 0A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75m-18 0v-7.5A2.25 2.25 0 0 1 5.25 9h13.5A2.25 2.25 0 0 1 21 11.25v7.5" />
                        </svg>
                        <span class="text-[10px] sm:text-xs font-medium text-slate-600">
                            {{ nextFunction.dateTime | date: 'dd/MM' }}
                        </span>
                    </div>

                    <!-- Price -->
                    <div class="flex items-center gap-1.5">
                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5"
                            stroke="currentColor" class="w-3 h-3 text-slate-600">
                            <path stroke-linecap="round" stroke-linejoin="round"
                                d="M12 6v12m-3-2.818.879.659c1.171.879 3.07.879 4.242 0 1.172-.879 1.172-2.303 0-3.182C13.536 12.219 12.768 12 12 12c-.725 0-1.45-.22-2.003-.659-1.106-.879-1.106-2.303 0-3.182s2.9-.879 4.006 0l.415.33M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z" />
                        </svg>
                        <span class="text-[10px] sm:text-xs font-bold text-slate-900">
                            <ng-container [ngSwitch]="event.pricingType">
                                <span *ngSwitchCase="'free'">Gratis ðŸŽ‰</span>
                                <span *ngSwitchCase="'pay-what-you-want'">
                                    A la gorra
                                    <!-- <span *ngIf="event.suggestedPrice" class="text-xs font-normal">(sugerido ${{
                                        event.suggestedPrice }})</span> -->
                                </span>
                                <span *ngSwitchCase="'fixed'">${{ nextFunction.price | number:'1.0-0' }}</span>
                                <span *ngSwitchDefault>${{ nextFunction.price | number:'1.0-0' }}</span>
                            </ng-container>
                        </span>
                    </div>
                </div>

                <!-- Right column: Capacity -->
                <div class="flex flex-col items-end justify-center">
                    <div class="flex items-center gap-1">
                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5"
                            stroke="currentColor" class="w-3 h-3 text-slate-600">
                            <path stroke-linecap="round" stroke-linejoin="round"
                                d="M15 19.128a9.38 9.38 0 0 0 2.625.372 9.337 9.337 0 0 0 4.121-.952 4.125 4.125 0 0 0-7.533-2.493M15 19.128v-.003c0-1.113-.285-2.16-.786-3.07M15 19.128v.106A12.318 12.318 0 0 1 8.624 21c-2.331 0-4.512-.645-6.374-1.766l-.001-.109a6.375 6.375 0 0 1 11.964-3.07M12 6.375a3.375 3.375 0 1 1-6.75 0 3.375 3.375 0 0 1 6.75 0Zm8.25 2.25a2.625 2.625 0 1 1-5.25 0 2.625 2.625 0 0 1 5.25 0Z" />
                        </svg>
                        <span class="text-[10px] sm:text-xs font-medium text-slate-600">
                            {{ nextFunction.capacity }}
                        </span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Location -->
        <div class="flex items-center gap-1.5 text-slate-500 text-[10px] sm:text-xs mb-0.5">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5"
                stroke="currentColor" class="w-3 h-3 flex-shrink-0">
                <path stroke-linecap="round" stroke-linejoin="round" d="M15 10.5a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z" />
                <path stroke-linecap="round" stroke-linejoin="round"
                    d="M19.5 10.5c0 7.142-7.5 11.25-7.5 11.25S4.5 17.642 4.5 10.5a7.5 7.5 0 1 1 15 0Z" />
            </svg>
            <span class="line-clamp-1">{{ event.locationAddress }}</span>
        </div>

        <!-- Action -->
        <a [routerLink]="['/e', event.aliasPublic]" *ngIf="!isSoldOut"
            class="block w-full text-center bg-primary hover:bg-primary-hover text-white font-semibold py-2.5 rounded-lg transition-colors shadow-sm mt-3">
            Ver detalle
        </a>

        <div *ngIf="isSoldOut"
            class="block w-full text-center bg-slate-400 text-white font-semibold py-2.5 rounded-lg cursor-not-allowed mt-3">
            Agotado
        </div>
    </div>
</div>